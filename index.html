<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unit Circle Practice</title>

<style>
* { box-sizing:border-box; margin:0; padding:0; font-family:Arial,sans-serif; }

body { background:#fff; }

/* ---------- TOP ---------- */
#topPanel {
  position:fixed; top:0; left:0; width:100%; height:180px;
  background:#f8f8f8; border-bottom:1px solid #ccc;
  display:flex; justify-content:space-around; align-items:center;
  z-index:10;
}

#topTimer { font-size:24px; font-weight:bold; }

.topButtons { display:flex; flex-direction:column; gap:10px; }
.topButtons button { padding:8px 14px; font-weight:bold; cursor:pointer; }

/* ---------- MAIN ---------- */
#scrollContainer { margin-top:200px; max-width:900px; margin-inline:auto; }
h1 { text-align:center; margin-bottom:10px; }

table {
  width:100%; border-collapse:collapse; border:2px solid black;
}
th,td { border:1px solid black; padding:8px; text-align:center; }

td input {
  width:100%; font-size:16px; padding:6px; text-align:center;
}

td.given { background:#eee; font-weight:bold; }
td.correct { background:#90ee90; }
td.incorrect { background:#ffb6c6; }

/* ---------- SYMBOL PANEL ---------- */
#floatingPanel {
  position:absolute; display:none;
  background:white; border:1px solid #999;
  padding:5px; border-radius:4px;
  z-index:20;
}

.symbol {
  display:inline-block; padding:4px 10px;
  background:#eee; cursor:pointer;
}

/* ---------- POPUP ---------- */
#overlay {
  position:fixed; inset:0;
  background:rgba(0,0,0,0.4);
  display:none; z-index:50;
}

#popup {
  background:white;
  width:300px;
  padding:20px;
  border-radius:8px;
  position:absolute;
  top:50%; left:50%;
  transform:translate(-50%,-50%);
  text-align:center;
}

#popup h2 { margin-bottom:10px; }
#popup button {
  margin-top:15px;
  padding:8px 20px;
  font-weight:bold;
  cursor:pointer;
}
</style>
</head>

<body>

<!-- ---------- TOP ---------- -->
<div id="topPanel">
  <div id="topTimer">00:00</div>
  <div class="topButtons">
    <button id="doneBtn">Done</button>
    <button onclick="location.reload()">Restart</button>
  </div>
</div>

<!-- ---------- MAIN ---------- -->
<div id="scrollContainer">
  <h1>Unit Circle – Solve for All Values</h1>

  <table>
    <thead>
      <tr>
        <th>radians</th><th>degrees</th><th>sin</th><th>cos</th><th>tan</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>
</div>

<!-- ---------- SYMBOL PANEL ---------- -->
<div id="floatingPanel">
  <div class="symbol" data-symbol="√">√</div>
  <div class="symbol" data-symbol="π">π</div>
</div>

<!-- ---------- POPUP ---------- -->
<div id="overlay">
  <div id="popup">
    <h2>Results</h2>
    <p id="scoreText"></p>
    <p id="percentText"></p>
    <button onclick="closePopup()">Close</button>
  </div>
</div>

<script>
const unitCircleValues = [
 { degrees:0,radians:"0",sin:"0",cos:"1",tan:"0" },
 { degrees:30,radians:"π/6",sin:"1/2",cos:"√3/2",tan:"1/√3" },
 { degrees:45,radians:"π/4",sin:"√2/2",cos:"√2/2",tan:"1" },
 { degrees:60,radians:"π/3",sin:"√3/2",cos:"1/2",tan:"√3" },
 { degrees:90,radians:"π/2",sin:"1",cos:"0",tan:"und." },
 { degrees:120,radians:"2π/3",sin:"√3/2",cos:"-1/2",tan:"-√3" },
 { degrees:135,radians:"3π/4",sin:"√2/2",cos:"-√2/2",tan:"-1" },
 { degrees:150,radians:"5π/6",sin:"1/2",cos:"-√3/2",tan:"-1/√3" },
 { degrees:180,radians:"π",sin:"0",cos:"-1",tan:"0" },
 { degrees:210,radians:"7π/6",sin:"-1/2",cos:"-√3/2",tan:"1/√3" },
 { degrees:225,radians:"5π/4",sin:"-√2/2",cos:"-√2/2",tan:"1" },
 { degrees:240,radians:"4π/3",sin:"-√3/2",cos:"-1/2",tan:"√3" },
 { degrees:270,radians:"3π/2",sin:"-1",cos:"0",tan:"und." },
 { degrees:300,radians:"5π/3",sin:"-√3/2",cos:"1/2",tan:"-√3" },
 { degrees:315,radians:"7π/4",sin:"-√2/2",cos:"√2/2",tan:"-1" },
 { degrees:330,radians:"11π/6",sin:"-1/2",cos:"√3/2",tan:"-1/√3" }
];

let problems=[], seconds=0, timer, lastFocusedInput=null;

/* ---------- TIMER ---------- */
timer=setInterval(()=>{
  seconds++;
  topTimer.textContent=
    String(Math.floor(seconds/60)).padStart(2,"0")+":"+
    String(seconds%60).padStart(2,"0");
},1000);

/* ---------- HELPERS ---------- */
function shuffle(a){ return [...a].sort(()=>Math.random()-0.5); }

function normalize(s){
  return s.toLowerCase()
    .replace(/\s+/g,"")
    .replace(/[()]/g,"")
    .replace(/°/g,"")
    .replace(/undefined/g,"und.")
    .replace(/und$/,"und.");
}

function alt(a){
  const f=[a];
  if(a==="1/√3") f.push("√3/3");
  if(a==="√3/3") f.push("1/√3");
  if(a==="-1/√3") f.push("-√3/3");
  if(a==="-√3/3") f.push("-1/√3");
  if(a==="und.") f.push("und","undefined");
  return f;
}

function correct(p,c,u){
  if(!u.trim()) return false;
  const n=normalize(u);
  if(n===normalize(p[c])) return true;
  return alt(p[c]).map(normalize).includes(n);
}

/* ---------- TABLE ---------- */
function render(){
  tableBody.innerHTML="";
  problems.forEach(p=>{
    const tr=document.createElement("tr");
    ["radians","degrees","sin","cos","tan"].forEach(c=>{
      const td=document.createElement("td");
      if(p.givenType===c){
        td.className="given";
        td.textContent=c==="degrees"?p[c]+"°":p[c];
      } else {
        const i=document.createElement("input");
        i.onfocus=()=>{lastFocusedInput=i; showPanel(i);};
        i.onblur=hidePanel;
        td.appendChild(i);
      }
      tr.appendChild(td);
    });
    tableBody.appendChild(tr);
  });
}

/* ---------- CHECK ---------- */
function checkAnswers(){
  document.activeElement.blur();
  clearInterval(timer);

  let correctCount=0, total=0;

  [...tableBody.rows].forEach((tr,i)=>{
    ["radians","degrees","sin","cos","tan"].forEach((c,j)=>{
      const td=tr.cells[j];
      if(td.classList.contains("given")) return;
      total++;
      td.classList.remove("correct","incorrect");
      if(correct(problems[i],c,td.firstChild.value)){
        td.classList.add("correct");
        correctCount++;
      } else {
        td.classList.add("incorrect");
      }
    });
  });

  showPopup(correctCount,total);
}

/* ---------- POPUP ---------- */
function showPopup(score,total){
  scoreText.textContent=`Score: ${score} / ${total}`;
  percentText.textContent=`Percentage: ${Math.round(score/total*100)}%`;
  overlay.style.display="block";
}

function closePopup(){
  overlay.style.display="none";
}

/* ---------- SYMBOL PANEL ---------- */
function showPanel(i){
  const r=i.getBoundingClientRect();
  floatingPanel.style.display="block";
  floatingPanel.style.top=(window.scrollY+r.top-floatingPanel.offsetHeight-5)+"px";
  floatingPanel.style.left=(window.scrollX+r.left)+"px";
}
function hidePanel(){ floatingPanel.style.display="none"; }

floatingPanel.querySelectorAll(".symbol").forEach(s=>{
  s.onmousedown=e=>{
    e.preventDefault();
    if(!lastFocusedInput) return;
    const i=lastFocusedInput, p=i.selectionStart;
    i.value=i.value.slice(0,p)+s.dataset.symbol+i.value.slice(p);
    i.selectionStart=i.selectionEnd=p+1;
    i.focus();
  };
});

/* ---------- INIT ---------- */
problems=shuffle(unitCircleValues).map(v=>{
  return {...v, givenType: Math.random()>.5?"radians":"degrees"};
});
render();
doneBtn.onclick=checkAnswers;
</script>

</body>
</html>
