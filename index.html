<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Unit Circle Practice</title>

<style>
* { margin:0; padding:0; box-sizing:border-box; font-family:Arial,sans-serif; }
html, body { height:100%; }
body { background:#fff; }

/* ---------- TOP PANEL ---------- */
#topPanel {
  position: fixed;
  top:0; left:0;
  width:100%; height:200px;
  background:#f8f8f8;
  border-bottom:1px solid #ccc;
  display:flex;
  align-items:center;
  justify-content: space-around;
  box-shadow:0 1px 2px rgba(0,0,0,0.1);
  z-index:10;
}

#topTimer { font-size:24px; font-weight:bold; }

.topButtons {
  display:flex;
  flex-direction: column;
  gap:10px;
}
.topButtons button {
  padding:8px 14px;
  font-weight:bold;
  cursor:pointer;
  min-width:90px;
}

/* ---------- MAIN CONTENT ---------- */
#scrollContainer {
  max-width:900px;
  margin:0 auto;
  margin-top:200px;
  padding-bottom:200px;
}

h1 { text-align:center; margin-bottom:6px; }

#note {
  text-align:center;
  font-size: 0.55em;
  margin-bottom:14px;
  color:#444;
}

.flex-container {
  display:flex;
  gap:20px;
  align-items:flex-start;
  flex-wrap:wrap;
  justify-content:center;
}

.flex-item { flex:1 1 300px; min-width:280px; display:flex; justify-content:center; }

/* ---------- TABLE ---------- */
table {
  width:100%;
  border-collapse:collapse;
  border:2px solid #000;
  margin-bottom:20px;
}

th, td {
  border:1px solid #000;
  padding:8px;
  text-align:center;
}

td input {
  width:100%;
  padding:6px;
  text-align:center;
  font-size:16px;
}

td.given { background:#f0f0f0; font-weight:bold; }
td.correct { background:#90ee90; }
td.incorrect { background:#ffb6c6; }

/* ---------- SVG RESPONSIVE ---------- */
.flex-item svg {
  width:100%;
  max-width:300px;
  height:auto;
  display:block;
  margin:auto;
}

/* ---------- SYMBOL PANEL ---------- */
#floatingPanel {
  position:absolute;
  display:none;
  background:#fff;
  border:1px solid #999;
  box-shadow:0 2px 5px rgba(0,0,0,0.2);
  padding:5px;
  border-radius:4px;
  z-index:9999;
}
.symbol {
  display:inline-block;
  font-size:20px;
  padding:4px 10px;
  margin:2px;
  background:#eee;
  border-radius:3px;
  cursor:pointer;
}

/* ---------- POPUP ---------- */
#overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.4);
  display:none;
  z-index:10000;
}
#popup{
  background:white;
  width:300px;
  padding:20px;
  border-radius:8px;
  position:absolute;
  top:50%; left:50%;
  transform:translate(-50%,-50%);
  text-align:center;
}
#popup button{
  margin-top:15px;
  padding:8px 20px;
  font-weight:bold;
  cursor:pointer;
}
</style>
</head>
<body>

<!-- ---------- TOP PANEL ---------- -->
<div id="topPanel">
  <svg id="topMiniCircle" viewBox="0 0 300 300" style="width:100px; height:100px;">
    <circle cx="150" cy="150" r="120" fill="none" stroke="black" stroke-width="2"/>
    <g id="miniAngleLines"></g>
  </svg>

  <div id="topTimer">00:00</div>

  <div class="topButtons">
    <button id="doneBtn">Done</button>
    <button id="restartBtn">Restart</button>
  </div>
</div>

<!-- ---------- MAIN ---------- -->
<div id="scrollContainer">
  <h1>Unit Circle – Solve for All Values</h1>
  <div id="note">
    <h1>For undefined values, type in "und."</h1>
  </div>

  <div class="flex-container">
    <!-- Table -->
    <div class="flex-item">
      <table>
        <thead>
          <tr>
            <th>radians</th>
            <th>degrees</th>
            <th>sin</th>
            <th>cos</th>
            <th>tan</th>
          </tr>
        </thead>
        <tbody id="tableBody"></tbody>
      </table>
    </div>

    <!-- Unit Circle -->
    <div class="flex-item">
      <svg id="unitCircleSVG" viewBox="0 0 300 300" style="border:2px solid #000; background:white; border-radius:4px;">
        <circle cx="150" cy="150" r="120" fill="none" stroke="black" stroke-width="2"/>
        <g id="angleLines"></g>
        <g id="anglePoints"></g>
      </svg>
    </div>
  </div>
</div>

<!-- ---------- SYMBOL PANEL ---------- -->
<div id="floatingPanel">
  <div class="symbol" data-symbol="√">√</div>
  <div class="symbol" data-symbol="π">π</div>
</div>

<!-- ---------- POPUP ---------- -->
<div id="overlay">
  <div id="popup">
    <h2>Results</h2>
    <p id="scoreText"></p>
    <p id="percentText"></p>
    <button id="closePopupBtn">Close</button>
  </div>
</div>

<script>
const unitCircleValues = [
 { degrees:0,radians:"0",sin:"0",cos:"1",tan:"0" },
 { degrees:30,radians:"π/6",sin:"1/2",cos:"√3/2",tan:"1/√3" },
 { degrees:45,radians:"π/4",sin:"√2/2",cos:"√2/2",tan:"1" },
 { degrees:60,radians:"π/3",sin:"√3/2",cos:"1/2",tan:"√3" },
 { degrees:90,radians:"π/2",sin:"1",cos:"0",tan:"und." },
 { degrees:120,radians:"2π/3",sin:"√3/2",cos:"-1/2",tan:"-√3" },
 { degrees:135,radians:"3π/4",sin:"√2/2",cos:"-√2/2",tan:"-1" },
 { degrees:150,radians:"5π/6",sin:"1/2",cos:"-√3/2",tan:"-1/√3" },
 { degrees:180,radians:"π",sin:"0",cos:"-1",tan:"0" },
 { degrees:210,radians:"7π/6",sin:"-1/2",cos:"-√3/2",tan:"1/√3" },
 { degrees:225,radians:"5π/4",sin:"-√2/2",cos:"-√2/2",tan:"1" },
 { degrees:240,radians:"4π/3",sin:"-√3/2",cos:"-1/2",tan:"√3" },
 { degrees:270,radians:"3π/2",sin:"-1",cos:"0",tan:"und." },
 { degrees:300,radians:"5π/3",sin:"-√3/2",cos:"1/2",tan:"-√3" },
 { degrees:315,radians:"7π/4",sin:"-√2/2",cos:"√2/2",tan:"-1" },
 { degrees:330,radians:"11π/6",sin:"-1/2",cos:"√3/2",tan:"-1/√3" }
];

let problems=[], timer=null, seconds=0, lastFocusedInput=null;

/* ---------- UTILITY ---------- */
function shuffle(a){ return [...a].sort(()=>Math.random()-0.5); }
function normalize(s){ return s.toLowerCase().replace(/\s+/g,"").replace(/[()]/g,"").replace(/°/g,"").replace(/undefined/g,"und.").replace(/und$/,"und."); }
function alternatives(a){
  const f=[a];
  if(a==="1/√3") f.push("√3/3");
  if(a==="√3/3") f.push("1/√3");
  if(a==="-1/√3") f.push("-√3/3");
  if(a==="-√3/3") f.push("-1/√3");
  if(a==="und.") f.push("und","undefined");
  return f;
}
function isCorrect(p,c,u){
  if(!u.trim()) return false;
  const n=normalize(u);
  if(n===normalize(p[c])) return true;
  return alternatives(p[c]).map(normalize).includes(n);
}

/* ---------- TABLE ---------- */
function renderTable(){
  const tb=document.getElementById("tableBody");
  tb.innerHTML="";
  problems.forEach(p=>{
    const tr=document.createElement("tr");
    ["radians","degrees","sin","cos","tan"].forEach(c=>{
      const td=document.createElement("td");
      if(p.givenType===c){
        td.className="given";
        td.textContent=c==="degrees"?p[c]+"°":p[c];
      } else {
        const i=document.createElement("input");
        i.onfocus=()=>{ lastFocusedInput=i; showFloatingPanel(i); }
        i.onblur=()=>{ floatingPanel.style.display="none"; };
        td.appendChild(i);
      }
      tr.appendChild(td);
    });
    tb.appendChild(tr);
  });
}

/* ---------- TIMER ---------- */
function startTimer(){
  clearInterval(timer);
  seconds=0;
  document.getElementById("topTimer").textContent="00:00";
  timer=setInterval(()=>{
    seconds++;
    const m=String(Math.floor(seconds/60)).padStart(2,"0");
    const s=String(seconds%60).padStart(2,"0");
    document.getElementById("topTimer").textContent=`${m}:${s}`;
  },1000);
}

/* ---------- CHECK ---------- */
function checkAnswers(){
  document.activeElement.blur();
  clearInterval(timer);
  let correct=0,total=0;
  [...document.querySelectorAll("#tableBody tr")].forEach((tr,i)=>{
    ["radians","degrees","sin","cos","tan"].forEach((c,j)=>{
      const td=tr.children[j];
      if(td.classList.contains("given")) return;
      total++;
      const val=td.querySelector("input").value;
      td.classList.remove("correct","incorrect");
      if(isCorrect(problems[i],c,val)){
        td.classList.add("correct");
        correct++;
      } else td.classList.add("incorrect");
    });
  });
  document.getElementById("scoreText").textContent=`Score: ${correct} / ${total}`;
  document.getElementById("percentText").textContent=`Percentage: ${Math.round(correct/total*100)}%`;
  document.getElementById("overlay").style.display="block";
}

/* ---------- RESTART ---------- */
function restart(){
  document.getElementById("overlay").style.display="none";
  problems=shuffle(unitCircleValues).map(v=>({...v,givenType:Math.random()>.5?"radians":"degrees"}));
  renderTable();
  startTimer();
}

/* ---------- SYMBOL PANEL ---------- */
function showFloatingPanel(i){
  const r=i.getBoundingClientRect();
  const fp=document.getElementById("floatingPanel");
  fp.style.display="block";
  fp.style.top=(window.scrollY+r.top-fp.offsetHeight-5)+"px";
  fp.style.left=(window.scrollX+r.left)+"px";
}

document.querySelectorAll(".symbol").forEach(s=>{
  s.onmousedown=e=>{
    e.preventDefault();
    if(!lastFocusedInput) return;
    const i=lastFocusedInput, p=i.selectionStart;
    i.value=i.value.slice(0,p)+s.dataset.symbol+i.value.slice(p);
    i.selectionStart=i.selectionEnd=p+1;
    i.focus();
  };
});

/* ---------- POPUP CLOSE ---------- */
document.getElementById("closePopupBtn").onclick = function() {
  document.getElementById("overlay").style.display="none";
};

/* ---------- INIT ---------- */
document.getElementById("doneBtn").onclick=checkAnswers;
document.getElementById("restartBtn").onclick=restart;
restart();

/* ---------- DRAW 16-LINE UNIT CIRCLE ---------- */
function drawCircle(){
  const linesG=document.getElementById("angleLines");
  const pointsG=document.getElementById("anglePoints");
  linesG.innerHTML=""; pointsG.innerHTML="";
  const cx=150, cy=150, r=120;
  const degrees=[0,30,45,60,90,120,135,150,180,210,225,240,270,300,315,330];
  degrees.forEach(d=>{
    const rad=d*Math.PI/180;
    const x=cx+r*Math.cos(rad);
    const y=cy-r*Math.sin(rad);
    // line
    const l=document.createElementNS("http://www.w3.org/2000/svg","line");
    l.setAttribute("x1",cx); l.setAttribute("y1",cy);
    l.setAttribute("x2",x); l.setAttribute("y2",y);
    l.setAttribute("stroke","#ccc"); l.setAttribute("stroke-width","1");
    linesG.appendChild(l);
    // point
    const p=document.createElementNS("http://www.w3.org/2000/svg","circle");
    p.setAttribute("cx",x); p.setAttribute("cy",y);
    p.setAttribute("r","3"); p.setAttribute("fill","black");
    pointsG.appendChild(p);
  });
}
drawCircle();

</script>
</body>
</html>
